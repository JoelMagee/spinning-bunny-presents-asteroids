<!doctype html>
<html>
	<head>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
		<script src="https://cdn.socket.io/socket.io-1.0.0.js"></script>
		<script>
		$(document).ready(function() {
			var connectButton = $("#connect");
			var connectText = $("#connect-message");

			var messageText = $("#message");
			var messageButton = $("#message-send");
			var globalMessageText = $("#message-global");
			var globalMessageButton = $("#message-send-global");

			var loginButton = $("#login-button");
			var loginUsername = $("#login-username");
			var loginPassword = $("#login-password");

			var logoutButton = $("#logout-button");

			var registerButton = $("#register-button");
			var registerUsername = $("#register-username");
			var registerPassword = $("#register-password");

			var joinButton = $("#join");
			var endButton = $("#end");
			var turnText = $("#turn-text");

			var connection = undefined;

			connectButton.on('click', function(){
				var socket = io();
				//socket.connect(); 

				joinButton.on('click', function() {
					socket.emit('session', {});
				});

				endButton.on('click', function() {
					socket.emit('turn', turnText.val());
					turnText.val("");
				});

				messageButton.on('click', function() {
					socket.emit('chat message', { message: messageText.val() });
					messageText.val("");
				});

				globalMessageButton.on('click', function() {
					socket.emit('global message', { message: globalMessageText.val() });
					globalMessageText.val("");
				});

				registerButton.on('click', function() {
					console.log("Register button clicked");

					var username = registerUsername.val();
					var password = registerPassword.val();

					socket.emit('register', {
						username: username,
						password: password
					});
				});

				loginButton.on('click', function() {
					console.log("Login button clicked");

					var username = loginUsername.val();
					var password = loginPassword.val();

					socket.emit('login', {
						username: username,
						password: password
					});
				})

				logoutButton.on('click', function() {
					console.log("Logout button clicked");

					socket.emit('logout', {});
				});

				socket.on('connect', function() {
					connectText.html("Connected...");
					console.log("Connected to websocket on localhost");
				});

				socket.on('disconnect', function() {
					connectText.html("Connection to websocket closed");
					console.log("Connection to localhost websocket has been closed");
				});

				socket.on('chat message', function(e) {
					console.log("Message from server: " + e);
				});

				socket.on('player join', function(e) {
					console.log("Player joined: " + e);
				});

				socket.on('player leave', function(e) {
					console.log("Player left: " + e);
				});

				socket.on('world', function(e) {
					console.log(e);
				});

				socket.on('players', function(e) {
					console.log("Players received");
					console.log(e);
				});

				socket.on('error-message', function(e) {
					console.error(e);
				})

				socket.on('turn result', function(e) {
					turnText.val(e);
				});

				socket.on('message', function(e) {
					console.log("Message from client");
					console.log(e);
				});

				socket.on('global message', function(e) {
					console.log("Global message from client");
					console.log(e);
				});

				socket.on('register', function(e) {
					if (e.success) {
						console.log("Registration successful");
					} else {
						console.log("Registration failed: " + e.message);
					}
				});

				socket.on('login', function(e) {
					if (e.success) {
						console.log("Login successful");
					} else {
						console.log("Login failed: " + e.message);
					}
				});

				socket.on('logout', function(e) {
					if (e.success) {
						console.log("Logout successful");
					} else {
						console.log("Logout failed (WTF?)");
					}
				});

			});


		});
		</script>
	</head>
	<body>
		<h1>Socks JS test</h1>
		<p>Socket makes connection on localhost:6400/echo</p>
		<hr>
		<button id="connect">Connect</button>
		<p id="connect-message"></p>
		<hr>
		<button id="join">Join</button>
		<hr>
		<input type="text" id="turn-text">
		<button id="end">End Turn</button>
		<hr>
		<p>Turn Result:</p>
		<p></p>
		<hr>
		<input type="text" id="message">
		<button id="message-send">Send message</button>
		<hr>
		<input type="text" id="message-global">
		<button id="message-send-global">Send Global message</button>
		<hr>
		<input type="text" id="register-username" placeholder="Username">
		<input type="text" id="register-password" placeholder="Password">
		<button id="register-button">Register</button>
		<hr>
		<input type="text" id="login-username" placeholder="Username">
		<input type="text" id="login-password" placeholder="Password">
		<button id="login-button">Login</button>
		<hr>
		<button id="logout-button">Logout</button>
	</body>
</html>